{% assign src_end = include.src | slice: -5, 5 %}

{% if src_end == ".html" %}
    {% assign page_src = "pagelets/" | append: include.src %}

    {% capture len %}{{page_src | size | minus: 5}}{% endcapture %}
    {% assign id = include.src | slice: 0, len %}
{% else %}
    {% assign page_src = "pagelets/" | append: include.src | append: "/index.html" %}
    {% assign id = include.src %}
{% endif %}

{% capture rendered %}
    {% include {{ page_src }} %}
{% endcapture %}

<article id="{{id}}">
    <header>
        <div>
            <div class="copylink">
                <a href="#{{id}}"><i class="fa fa-link"></i></a>
            </div>
            <div class="title">{{ include.title }}</div>
            {% if include.description %}
            <div class="description">{{ include.description }}</div>
            {% endif %}
            {% if include.note %}
            <div class="note">{{ include.note }}</div>
            {% endif %}
        </div>
    </header>
    <section>
        {{ rendered }}
    </section>
</article>
